---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const allMedia = await getCollection('media');
---
<Layout title="Character Media Archive">
  <header>
    <h1>Character Archive</h1>
    <div id="search"></div> </header>

  <main class="masonry-grid">
    {allMedia.map((item) => (
      <article 
        class="media-card" 
        data-pagefind-body 
        data-pagefind-filter={`Skin: ${item.data.skin_line}, Type: ${item.data.media_type}`}
      >
        <Image 
          src={item.data.image} 
          alt={item.data.alt_text} 
          width={400} 
          height={600} 
          format="webp" 
          quality={80} 
        />
        <div class="meta">
          <h2>{item.data.title}</h2>
          <p>By {item.data.artist}</p>
        </div>
      </article>
    ))}
  </main>
</Layout>

<style>
 .masonry-grid {
    column-count: 1;
    column-gap: 1rem;
    padding: 1rem;
  }
  @media (min-width: 768px) {.masonry-grid { column-count: 3; } }
  @media (min-width: 1024px) {.masonry-grid { column-count: 4; } }
  
 .media-card {
    break-inside: avoid;
    margin-bottom: 1rem;
    position: relative;
    border-radius: 8px;
    overflow: hidden;
  }
 .media-card img {
    width: 100%;
    height: auto;
    display: block;
  }
</style>